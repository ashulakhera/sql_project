-- Analyze the cumulative revenue generated over time.

select order_date, sum(revenue)over(order by order_date) as cum_revenue
from
(select orders.order_date,
round(SUM(order_details.quantity * pizzas.price),0) as revenue
from order_details
join pizzas
on order_details.pizza_id=pizzas.pizza_id
join orders
on orders.order_id = order_details.order_id
group by orders.order_date) as sales;

#################EXAMPLE_OUTPUT##################

order_date	cum_revenue
2015-01-01	2714
2015-01-02	5446
2015-01-03	8108
2015-01-04	9863
2015-01-05	11929
2015-01-06	14358
2015-01-07	16560
2015-01-08	19398
2015-01-09	21525
2015-01-10	23989
2015-01-11	25861
2015-01-12	27780
2015-01-13	29830
2015-01-14	32357
2015-01-15	34342
2015-01-16	36936
2015-01-17	39000
2015-01-18	40977
2015-01-19	43364
2015-01-20	45762
2015-01-21	47803
2015-01-22	50300
2015-01-23	52724
2015-01-24	55013
2015-01-25	56631
2015-01-26	58515
2015-01-27	61043
2015-01-28	63059
2015-01-29	65104
2015-01-30	67374
2015-01-31	69792
2015-02-01	72981
2015-02-02	75310
2015-02-03	77925
2015-02-04	80159
2015-02-05	82375
2015-02-06	84885
2015-02-07	87123
2015-02-08	89158
2015-02-09	91353
2015-02-10	93410
2015-02-11	95870
2015-02-12	98029
2015-02-13	100783
2015-02-14	103102
2015-02-15	105243
2015-02-16	107212
2015-02-17	109334
2015-02-18	111977
2015-02-19	114007
2015-02-20	116898
2015-02-21	119009
2015-02-22	120589
2015-02-23	122758
2015-02-24	124953
2015-02-25	127294
2015-02-26	129555
2015-02-27	132413
2015-02-28	134953
2015-03-01	136552
2015-03-02	138931
2015-03-03	141219
2015-03-04	143663
2015-03-05	146014
2015-03-06	148528
2015-03-07	150928
2015-03-08	153116
2015-03-09	155451
2015-03-10	157840
2015-03-11	160048
2015-03-12	162043
2015-03-13	164830
2015-03-14	166869
2015-03-15	168938
2015-03-16	171233
2015-03-17	174198
2015-03-18	176273
2015-03-19	178662
2015-03-20	181123
2015-03-21	183390
2015-03-22	184649
2015-03-23	186882
2015-03-24	189044
2015-03-25	190972
2015-03-26	193188
2015-03-27	195933
2015-03-28	198185
2015-03-29	200339
2015-03-30	202594
2015-03-31	205351
2015-04-01	207528
2015-04-02	210075
2015-04-03	212613
2015-04-04	215381
2015-04-05	217291
2015-04-06	219913
2015-04-07	222147
2015-04-08	224441
2015-04-09	226488
2015-04-10	228913
2015-04-11	231457
2015-04-12	233451
2015-04-13	235947
2015-04-14	238453
2015-04-15	241032
2015-04-16	243050
2015-04-17	245726
2015-04-18	248012
2015-04-19	249540
2015-04-20	251999
2015-04-21	254212
2015-04-22	256405
2015-04-23	258831
2015-04-24	261810
2015-04-25	263899
2015-04-26	265666
2015-04-27	267847
2015-04-28	269590
2015-04-29	271419
2015-04-30	274087
2015-05-01	276659
2015-05-02	279059
2015-05-03	280891
2015-05-04	283180
2015-05-05	284894
2015-05-06	287204
2015-05-07	289433
2015-05-08	292485
2015-05-09	294853
2015-05-10	297141
2015-05-11	299529
2015-05-12	301829
2015-05-13	304091
2015-05-14	306785
2015-05-15	310171
2015-05-16	312452
2015-05-17	314280
2015-05-18	316490
2015-05-19	318477
2015-05-20	320850
2015-05-21	322913
2015-05-22	325548
2015-05-23	327992
2015-05-24	330189
2015-05-25	332293
2015-05-26	334169
2015-05-27	336266
2015-05-28	338282
2015-05-29	341283
2015-05-30	343770
2015-05-31	345488
2015-06-01	348556
2015-06-02	351006
2015-06-03	352913
2015-06-04	355197
2015-06-05	357897
2015-06-06	360178
2015-06-07	362139
2015-06-08	364404
2015-06-09	366847
2015-06-10	368866
2015-06-11	371516
2015-06-12	373655
2015-06-13	376164
2015-06-14	378023
2015-06-15	380619
2015-06-16	382517
2015-06-17	384654
2015-06-18	386638
2015-06-19	389431
2015-06-20	391492
2015-06-21	393417
2015-06-22	395736
2015-06-23	397779
2015-06-24	400107
2015-06-25	402506
2015-06-26	405252
2015-06-27	408065
2015-06-28	409635
2015-06-29	411509
2015-06-30	413720
2015-07-01	415952
2015-07-02	418247
2015-07-03	421690
2015-07-04	425554
2015-07-05	427145
2015-07-06	429262
2015-07-07	431636
2015-07-08	434032
2015-07-09	436330
2015-07-10	438762
2015-07-11	440848
2015-07-12	443034
2015-07-13	445094
2015-07-14	447050
2015-07-15	449552
2015-07-16	452016
2015-07-17	455148
2015-07-18	457270
2015-07-19	459293
2015-07-20	461794
2015-07-21	463825
2015-07-22	466117
2015-07-23	468331
2015-07-24	471535
2015-07-25	473772
2015-07-26	475644
2015-07-27	477816
2015-07-28	479911
2015-07-29	481834
2015-07-30	484183
2015-07-31	486278
2015-08-01	488719
2015-08-02	490629
2015-08-03	492611
2015-08-04	494701
2015-08-05	496796
2015-08-06	498895
2015-08-07	501521
2015-08-08	504237
2015-08-09	506240
2015-08-10	508379
2015-08-11	510669
2015-08-12	513035
2015-08-13	515109
2015-08-14	518126
2015-08-15	520378
2015-08-16	522517
2015-08-17	525143
2015-08-18	527244
2015-08-19	529577
2015-08-20	531485
2015-08-21	534086
2015-08-22	536492
2015-08-23	538194
2015-08-24	539891
2015-08-25	541850
2015-08-26	544179
2015-08-27	546297
2015-08-28	548944
2015-08-29	550979
2015-08-30	552474
2015-08-31	554555
2015-09-01	556908
2015-09-02	558774
2015-09-03	561027
2015-09-04	563988
2015-09-05	566526
2015-09-06	568018
2015-09-07	570301
2015-09-08	572551
2015-09-09	575131
2015-09-10	577547
2015-09-11	580309
2015-09-12	582897
2015-09-13	584735
2015-09-14	586900
2015-09-15	589450
2015-09-16	591635
2015-09-17	593877
2015-09-18	596599
2015-09-19	598886
2015-09-20	600715
2015-09-21	602846
2015-09-22	605016
2015-09-23	607179
2015-09-26	609426
2015-09-27	611741
2015-09-28	613776
2015-09-29	616538
2015-09-30	618736
2015-10-01	621938
2015-10-02	624013
2015-10-03	626414
2015-10-04	628556
2015-10-06	630772
2015-10-07	632864
2015-10-08	634840
2015-10-09	637353
2015-10-10	639663
2015-10-11	641579
2015-10-13	643905
2015-10-14	646051
2015-10-15	650371
2015-10-16	652926
2015-10-17	655266
2015-10-18	657061
2015-10-20	659498
2015-10-21	661958
2015-10-22	664359
2015-10-23	666970
2015-10-24	669650
2015-10-25	671487
2015-10-27	673476
2015-10-28	675112
2015-10-29	677282
2015-10-30	680019
2015-10-31	682764
2015-11-01	684751
2015-11-02	687050
2015-11-03	688879
2015-11-04	690845
2015-11-05	693025
2015-11-06	696182
2015-11-07	698763
2015-11-08	700873
2015-11-09	703357
2015-11-10	705400
2015-11-11	707346
2015-11-12	709911
2015-11-13	712176
2015-11-14	714501
2015-11-15	716323
2015-11-16	718580
2015-11-17	720537
2015-11-18	722649
2015-11-19	725344
2015-11-20	727732
2015-11-21	729816
2015-11-22	731185
2015-11-23	733650
2015-11-24	735880
2015-11-25	738243
2015-11-26	742649
2015-11-27	747071
2015-11-28	749039
2015-11-29	750938
2015-11-30	753161
2015-12-01	755238
2015-12-02	757452
2015-12-03	759695
2015-12-04	762573
2015-12-05	765201
2015-12-06	767551
2015-12-07	769966
2015-12-08	771822
2015-12-09	774394
2015-12-10	776380
2015-12-11	779014
2015-12-12	780974
2015-12-13	783219
2015-12-14	785392
2015-12-15	787779
2015-12-16	790014
2015-12-17	791895
2015-12-18	794781
2015-12-19	797085
2015-12-20	799190
2015-12-21	801291
2015-12-22	803174
2015-12-23	805418
2015-12-24	807556
2015-12-26	809199
2015-12-27	810618
2015-12-28	812255
2015-12-29	813608
2015-12-30	814946
2015-12-31	817862

